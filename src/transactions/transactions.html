<!-- 
 Account Detail
-->
<div layout="row" >
	<md-card>
		<div>Div3</div>
	</md-card>

	<md-card>
		<div>Div2</div>
	</md-card>

	<md-card>
		<div>Div1</div>
	</md-card>
</div>

<!-- Main datatable -->
<md-card>
	<!-- Action Toolbar -->
	<md-toolbar class="md-table-toolbar md-default" >
		<div class="md-toolbar-tools">
			<span>Transactions</span>
			<span flex></span>
			<!-- Add Button -->
			<md-button class="md-icon-button" ng-click="ctrl.addNewTransaction()">
				<md-icon>add</md-icon>
			</md-button>
			<!-- Delete Button -->
			<md-button class="md-icon-button" ng-click="ctrl.deleteTransaction()">
				<md-icon>delete</md-icon>
			</md-button>
			<!-- Filter Button -->
			<md-button class="md-icon-button">
				<md-icon>filter_list</md-icon>
			</md-button>

			<!-- Menu -->
			<md-menu md-position-mode="target-right target">
				<!-- More Button -->
				<md-button class="md-icon-button" aria-label="Parameters" ng-click="openMenu($mdMenu, $event)">
					<md-icon md-menu-origin>more_vert</md-icon>
				</md-button>
				<md-menu-content width="4">
					<md-menu-item>
						<md-button ng-click="addNewCategory($event)">
							New category ...
						</md-button>
					</md-menu-item>
					<md-menu-item>
						<md-button ng-click="addNewBankAccount($event)">
							New bank account ...
						</md-button>
					</md-menu-item>
				</md-menu-content>
			</md-menu>
		</div>
	</md-toolbar>

	<md-table-container>
		<table md-table md-row-select multiple ng-model="itemSelected" md-progress="transactions" >

			<!-- Column definition -->
			<thead md-head data-md-order="query.order">
				<tr md-row>
					<th md-column md-order-by="dateToDisplay" width="10%">Date</th>
					<th md-column md-order-by="transaction.label" width="30%">Description</th>
					<th md-column md-order-by="transaction.category.label">Category</th>
					<th md-column md-order-by="transaction.bankaccount.label">Account</th>
					<th md-column md-order-by="transaction.income" width="10%">Income</th>
					<th md-column md-order-by="transaction.outcome" width="10%">Outcome</th>
					<th md-column width="3%"></th>
				</tr>
			</thead>

			<!-- Table content -->
			<tbody md-body>
				<tr md-row md-select="item" md-select-id="item.transaction._id" ng-repeat="item in items | orderBy : query.order | limitTo: query.limit : (query.page - 1) * query.limit">

					<!-- Date --> 
					<td md-cell><md-datepicker ng-model="item.dateToDisplay" md-placeholder="Enter date"  md-hide-icons="calendar" ng-change="item.transaction.date = item.dateToDisplay.toISOString();onChange(item)" ng-blur="onBlur(item)"></md-datepicker></td>

					<!-- Transaction Label -->
					<td md-cell><input width="100%" ng-model="item.transaction.label" size=60 ng-change="onChange(item)" ng-blur="onBlur(item)"></td>

					<!-- Category -->
					<td md-cell>
						<md-select ng-model="item.transaction.category" placeholder="Select a category" ng-model-options="{trackBy: '$value.id'}" ng-change="onChange(item)" ng-blur="onBlur(item)" multiple="false">
							<md-optgroup label="{{currentParent}}" ng-repeat="currentParent in categories.type">
								<md-option  ng-value="category" ng-repeat="category in categories | filter: {category: currentParent}">{{category.label}}</md-option>
							</md-optgroup>
						</md-select>
					</td>

					<!-- Bank Account -->
					<td md-cell>
						<md-select ng-model="item.transaction.bankaccount" placeholder="Select a bank account" ng-model-options="{trackBy: '$value.id'}" ng-change="onChange(item)" ng-blur="onBlur(item)">
							<md-optgroup label="{{currentType}}" ng-repeat="currentType in bankaccountList.type">
								<md-option  ng-value="bankaccount" ng-repeat="bankaccount in bankaccountList | filter: {category: currentType}">{{bankaccount.label}}</md-option>
							</md-optgroup>
						</md-select>
					</td>

					<!-- Income -->
					<td md-cell><input ng-model="item.transaction.income" type="number" ng-change="onChange(item)" ng-blur="onBlur(item)"></td>

					<!-- Outcome -->
					<td md-cell><input ng-model="item.transaction.outcome" type="number" ng-change="onChange(item)" ng-blur="onBlur(item)"></td>

					<!-- Progress -->
					<td md-cell><md-progress-circular md-mode="indeterminate" md-diameter="20px" ng-show="item.currentlySaving"></md-progress-circular></td>
				</tr>
			</tbody>
		</table>
	</md-table-container>

	<!-- Pagination -->
	<md-table-pagination md-limit="query.limit" md-page="query.page" md-limit-options="query.query" md-page-select md-total="{{items.length}}">
	</md-table-pagination>
</md-card>